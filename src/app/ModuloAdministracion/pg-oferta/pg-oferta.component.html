<div class="card separador-componentes">
    <p-toolbar>
      <div class="p-toolbar-group-center">
        <p>INFORMACIÓN OFERTAS</p>
      </div>
      <div class="p-toolbar-group-end">
        <p-button
          type="button"
          icon="pi pi-plus"
          styleClass="p-button-text"
          (click)="ModalNuevoInformacion()"
        ></p-button>
      </div>
    </p-toolbar>
  
    <p-table
    [value]="lsListado"
    [paginator]="true"
    [rows]="10"
    [showCurrentPageReport]="true"
    [tableStyle]="{ 'min-width': '10rem' }"
    styleClass="p-datatable-sm"
    currentPageReportTemplate="Mostrar {first} - {last} de {totalRecords} elementos"
    [rowsPerPageOptions]="[10, 25, 50]"
  >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="ofertas_id" (click)="onSortChange('ofertas_id')"> 
            # <p-sortIcon field="ofertas_id"></p-sortIcon>
          </th>
          <th >
            Descripcion
          </th>
          <th pSortableColumn="gc_necesarios">
            Green Coins Necesarios<p-sortIcon field="gc_necesarios" (click)="onSortChange('gc_necesarios')"></p-sortIcon>
          </th>
          <th pSortableColumn="neg">
            Negocio
            <p-sortIcon field="neg"></p-sortIcon>
          </th>
          <th pSortableColumn="fec_ini">
            Fecha de Inicio
            <p-sortIcon field="fec_ini"></p-sortIcon>
          </th>
          <th pSortableColumn="fec_fin">
            Fecha de Finalizacion
            <p-sortIcon field="fec_fin"></p-sortIcon>
          </th>
          <th pSortableColumn="est">
            Estado
            <p-sortIcon field="est"></p-sortIcon>
          </th>
          <th >ACCIONES </th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-customer>
        <tr>          
          <td>{{ customer.ofertas_id }}</td>
          <td>{{ customer.descripcion }}</td>
          <td>{{ customer.gc_necesarios }}</td>
          <td>{{ (customer.negocioInfo) }}</td>
          <td>{{ formatDate(customer.fecha_inicio)  }}</td>
          <td>{{ formatDate(customer.fecha_fin) }}</td>
          <td>
          
            <p-tag *ngIf="customer.estado == false" severity="danger" [value]="'DESACTIVADO'"></p-tag>
            <p-tag *ngIf="customer.estado == true" severity="success" [value]="'ACTIVO'"></p-tag>
           
          <td>
            <p-button
              type="button"
              icon="pi pi-pencil"
              styleClass="p-button-text"
              (click)="ModalEditarInformacion(customer)"
            ></p-button>
            <p-button
              type="button"
              icon="pi pi-trash"
              styleClass="p-button-text"
              (click)="ModalCambiarEstado(customer)"
            ></p-button>
          </td>
        </tr>
      </ng-template>
     
     
    </p-table>
  </div>
  <p-dialog
    header="Nuevo"
    [(visible)]="visibleNuevo"
    [modal]="true"
    [style]="{ width: '50vw', minWidth: '300px', maxWidth: '80vw' }"
    [draggable]="false"
    [resizable]="false"
  >
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">Nueva Oferta</span>
  </ng-template>
  <ng-template pTemplate="content">
    <label for="descripcion" class="form-label" style="font-size: 14px;">Descripcion: </label>
    <div class="p-inputgroup">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input pInputText placeholder="Descripcion" [(ngModel)]="descripcion" class="p-inputtext-sm" (input)="descripcion = descripcion" required/>
    </div>
    <label for="gc_necesarios" class="form-label" style="font-size: 14px;">Green Coins necesarios:  </label>
    <div class="p-inputgroup" style="margin-top: 15px;">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input pInputText placeholder="Green Coins Necesarios" [(ngModel)]="gc_necesarios" class="p-inputtext-sm" (input)="gc_necesarios = gc_necesarios" required/>
    </div>

    <label for="" class="form-label" style="font-size: 14px;">Negocio:  </label>
    <div class="p-inputgroup" style="margin-top: 15px;">
      <span class="p-inputgroup-addon">
        <i class="pi pi-pencil"></i>
      </span>
      <select name="" id="" required (change)="onNegocioChange($event)">
        <option value="0" disabled [selected]="negocio_id === 0">Elegir el Negocio</option>
        <option *ngFor="let negocio of negocios" [value]="negocio.negocio_id">{{ negocio.nombre }}</option>
      </select>
    </div>

    <label for="" class="form-label" style="font-size: 14px;">Fecha Inicio:  </label>
    <div class="p-inputgroup" style="margin-top: 15px;">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input type="date" placeholder="Fecha de inicio" [(ngModel)]="fecha_inicio" class="p-inputtext-sm" (input)="fecha_inicio = fecha_inicio" [min]="minDate" [max]="(maxDate)" required/>
      <div class="invalid-feedback floating-invalid-feedback">Ingresa una fecha de inicio válida.</div>
    </div>

    <label for="" class="form-label" style="font-size: 14px;">Fecha Finalizacion:  </label>
    <div class="p-inputgroup" style="margin-top: 15px;">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input type="date" placeholder="Fecha de Finalizacion" [(ngModel)]="fecha_fin" class="p-inputtext-sm" (input)="fecha_fin = fecha_fin" [min]="minDatefin" [max]="maxDate" required/>
    </div>
  </ng-template>
  
  <ng-template pTemplate="footer">
    <p-button icon="pi pi-save"  label="Registrar" styleClass="p-button-sm" (click)="RegistrarNuevo()"></p-button>
  </ng-template>
  
  </p-dialog>
  <p-dialog
    header="Actualización"
    [(visible)]="visibleEditar"
    [modal]="true"
    [style]="{ width: '50vw', minWidth: '300px', maxWidth: '80vw' }"
    [draggable]="false"
    [resizable]="false"
  >
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">Actualización</span>
  </ng-template>
  
  <ng-template pTemplate="content">
    <div class="p-inputgroup">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input pInputText placeholder="Valor" [(ngModel)]="objSeleccion.int_valor" class="p-inputtext-sm"/>
    </div>
  </ng-template>
  
  <ng-template pTemplate="footer">
    <p-button icon="pi pi-save"  label="Actualizar" styleClass="p-button-sm" (click)="RegistrarActualizacion()"></p-button>
  </ng-template>
  
  </p-dialog>
  <p-dialog
    header="Estado"
    [(visible)]="visibleEstado"
    [modal]="true"
    [style]="{ width: '50vw', minWidth: '300px', maxWidth: '80vw' }"
    [draggable]="false"
    [resizable]="false"
  >
  <ng-template pTemplate="header">
    <span class="text-xl font-bold">{{strEstado}}</span>
  </ng-template>
  
  <ng-template pTemplate="content">
    <div class="p-inputgroup">
      <span class="p-inputgroup-addon">
          <i class="pi pi-pencil"></i>
      </span>
      <input pInputText placeholder="Estado" [(ngModel)]="objSeleccion.int_valor" class="p-inputtext-sm" readonly/>
    </div>
  </ng-template>
  
  <ng-template pTemplate="footer">
    <p-button icon="pi pi-save"  label="Guardar" styleClass="p-button-sm" (click)="EstadoCambiarActualizacion()"></p-button>
  </ng-template>
  
  </p-dialog>
  <p-toast></p-toast>